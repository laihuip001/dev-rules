# 開発日記: 2026-01-14 (Tue)

## 📝 Summary

言語ルール違反（英語混入）の再発防止策として「二段階ロック方式」を設計・実装した。グローバル設定に最小限のKERNEL LOCKを常駐させ、詳細ルールはセッション開始時に動的読み込みする多層防御構造を確立。

---

## 📁 File Changes

### dev-rules

- `GEMINI.md`: Session Initialization + Last-Mile Checkpoint セクション追加
- `.agent/workflows/init.md`: 新規作成 - セッション開始時の憲法読み込みワークフロー
- `README.md`: 配置要件と二段階ロック構造の説明を追加

### Flow

- `.gemini/GEMINI.md`: KERNEL_LOCK v4.0.0 に置換（51行、ブートストラップ専用）
- `.agent/workflows/init.md`: dev-rulesから同期

---

## 🎯 Decisions

| 決定事項 | 理由 |
|---|---|
| 二段階ロック方式の採用 | user_rulesへの全ルール直書きはトークン効率が悪く、減衰リスクもある。最重要ルールのみ常駐+詳細は動的読み込みが最適解。 |
| KERNEL_LOCKへの最小ルール選定 | 言語強制、禁止事項、通信ポリシーの3つは「違反が即座に悪影響」となるため常駐必須。 |
| パスのハードコード許容 | 完全個人使用のため、環境可搬性より即効性を優先。 |

---

## 💡 Learnings

- **LLMのAttention Drift**: ツール呼び出し時、パラメータ生成に認知リソースが集中し、ルール想起が後回しになる現象がある。
- **コンテキストウィンドウの「位置」が重要**: 直近に読み込まれた情報ほどLLMが重視する。KERNEL_LOCKで詳細ルールを冒頭に配置する意図。
- **M-07 (Devil's Advocate) の有効性**: 自己批判プロセスを経ることで、設計の穴を事前に発見できた。

---

## ➡️ Next Steps

- [ ] 別セッションで二段階ロック方式の動作テストを実施
- [ ] Protocol D 鮮度チェックの自動化検討
- [ ] Flow v5.0 リリース準備の継続

---

*Generated by /diary workflow*
